## **定义性张力系统 (SDT)：形式化规范**

### **第 1 节 语法 (Syntax)**

****定义 1.1 (字母表)**
系统的字母表 $\Sigma$ 由以下四个不相交的集合构成：
1.  一个可数的**变量符号集** (Variable Symbols) $\mathcal{S} = \{s_1, s_2, \dots\}$。
2.  一个包含两个**常量符号** (Constant Symbols) 的集合 $\mathcal{C} = \{(), \bot\}$。
3.  一个单元素集合，包含二元**连接符** `:=`。
4.  一个单元素集合，包含二元**关系符号** `~`。

**定义 1.2 (项)**
SDT 的**项集** $\mathcal{T}$ 是满足以下条件的最小集合：
1.  **原子项**: 若 $s \in \mathcal{S}$，则 $s \in \mathcal{T}$。常量 `()` 和 `⊥` 也是 $\mathcal{T}$ 中的原子项。
2.  **定义项**: 若 $t_1, t_2 \in \mathcal{T}$，则 $(t_1 := t_2) \in \mathcal{T}$。

**定义 1.3 (方程)**
一个**方程 (Equation)** 是形如 `t₁ ~ t₂` 的表达式，其中 $t_1, t_2 \in \mathcal{T}$。系统的**方程集**记为 $\mathcal{E}$。

### **第 2 节 证明论 (Proof Theory)**

证明论由形如 `Γ ⊢ t₁ ~ t₂` 的**判断 (Judgment)** 构成。此判断断定方程 `t₁ ~ t₂` 可由上下文 `Γ` 推导得出。一个**上下文 (Context)** `Γ` 是一个由方程组成的有限集合。

**定义 2.1 (推理规则)**

**A. 结构规则**
关系 `⊢` 蕴含了一个关于 `~` 的等价关系，满足以下公理：
*   **(Reflexivity)**: $\dfrac{}{\Gamma \vdash t \sim t}$
*   **(Symmetry)**: $\dfrac{\Gamma \vdash t_1 \sim t_2}{\Gamma \vdash t_2 \sim t_1}$
*   **(Transitivity)**: $\dfrac{\Gamma \vdash t_1 \sim t_2 \qquad \Gamma \vdash t_2 \sim t_3}{\Gamma \vdash t_1 \sim t_3}$
*   **(Weakening)**: $\dfrac{\Gamma \vdash t_1 \sim t_2}{\Gamma, t_3 \sim t_4 \vdash t_1 \sim t_2}$

系统满足假设规则：
*   **(Hypothesis)**: $\dfrac{(t_1 \sim t_2) \in \Gamma}{\Gamma \vdash t_1 \sim t_2}$

**B. 定义连接符规则**
*   **(Congruence)**: $\dfrac{\Gamma \vdash t_1 \sim s_1 \qquad \Gamma \vdash t_2 \sim s_2}{\Gamma \vdash (t_1 := t_2) \sim (s_1 := s_2)}$
*   **(Def-Reflection)**: $\dfrac{\Gamma \vdash t_1 \sim t_2}{\Gamma \vdash (t_1 := t_2) \sim ()}$
*   **(Def-Elim)**: $\dfrac{\Gamma \vdash (t_1 := t_2) \sim ()}{\Gamma \vdash t_1 \sim t_2}$
*   **(Reif)**: $\dfrac{}{\Gamma \vdash t \sim (t := ())}$
*   **(Def-Absurdity)**: $\dfrac{}{\Gamma, x \sim (x := \bot) \vdash \bot \sim ()}$

### **第 3 节 指称语义 (Denotational Semantics)**

**定义 3.1 (语义域)**

我们通过标准的**归纳构造法**来定义系统的**语义域** `V`，将其形式化为满足此规范的**最小集合**：

1.  **基础层 (Base Layer)**: 令 $V_0 = \{(), \bot\}$。
2.  **归纳步骤 (Inductive Step)**: 对任意自然数 $n \ge 0$，归纳定义后继层 $V_{n+1} = V_0 \cup (V_n \times V_n)$。
3.  **极限集合 (Limit Set)**: 语义域 `V` 被定义为所有层的并集：
    $$ V = \bigcup_{n=0}^{\infty} V_n $$

我们将 `()` 和 `⊥` 称为**原子值**。我们将形如 `⟨v₁, v₂⟩` 的值称为**滞留对 (Residual Pair)**。

**评注 (Justification for the revision):**
通过此分层构造法定义的集合 `V` 在 ZFC 框架内是**良定义的 (well-defined)**。它是一个**良基集合 (well-founded set)**，符合正则性公理的要求。

**定义 3.2 (环境)**
一个**环境** `ρ` 是一个从变量符号集 `S` 到语义域 `V` 的全函数：
$$ \rho: \mathcal{S} \to V $$

**定义 3.3 (语义求值)**
一个项 `t ∈ T` 在环境 `ρ` 下的**语义值** `⟦ t ⟧_ρ ∈ V`，由对 `t` 的结构递归定义的函数 `⟦ · ⟧_ρ: T → V` 给出：

1.  `⟦ () ⟧_ρ = ()`
2.  `⟦ ⊥ ⟧_ρ = ⊥`
3.  `⟦ s ⟧_ρ = ρ(s)`  (对于 `s ∈ S`)
4.  对于复合项 `(t₁ := t₂)`，其值定义如下，首先计算 `v₁ = ⟦ t₁ ⟧_ρ` 和 `v₂ = ⟦ t₂ ⟧_ρ`：
    $$
    ⟦ (t_1 := t_2) ⟧_\rho =
    \begin{cases}
    () & \text{若 } v_1 \equiv v_2 \\
    v_1 & \text{若 } v_1 \not\equiv v_2 \text{ 且 } v_2 \equiv () \\
    \bot & \text{若 } v_1 \equiv () \text{ 且 } v_2 \equiv \bot \\
    \langle v_1, v_2 \rangle & \text{在其他所有情况下}
    \end{cases}
    $$
    其中 `≡` 是 `V` 上的同一性关系（即标准集合论中的相等）。以上四个情况是互斥且完备的。

**定义 3.4 (满足与语义蕴含)**
*   **环境满足**: 一个环境 `ρ` **满足**一个等式 `t₁ ~ t₂`，记为 `ρ ⊨ t₁ ~ t₂`，当且仅当 `⟦ t₁ ⟧_ρ ≡ ⟦ t₂ ⟧_ρ`。
*   **上下文满足**: 一个环境 `ρ` 满足一个上下文 `Γ`，记为 `ρ ⊨ Γ`，当且仅当对于 `Γ` 中所有的等式 `t_a ~ t_b`，都有 `ρ ⊨ t_a ~ t_b`。
*   **语义蕴含**: `Γ` 语义蕴含 `t₁ ~ t₂`，记为 `Γ ⊨ t₁ ~ t₂`，当且仅当对于所有环境 `ρ`，若 `ρ ⊨ Γ`，则 `ρ ⊨ t₁ ~ t₂`。

---

### **第 4 节 系统可靠性 (Soundness)**

本节旨在证明 SDT 的证明论相对于其指称语义是可靠的。

**引理 4.1.0 (求值函数的良定义性)**
求值函数 `⟦ · ⟧_ρ : T → V` 对于任意环境 `ρ` 都是一个良定义的全函数。这意味着对于任意项 `t ∈ T`，`⟦ t ⟧_ρ` 的计算过程终止，且其结果是一个唯一的、属于 `V` 的元素。

**证明**:
我们通过对项 `t ∈ T` 的结构进行结构归纳法来证明。对于任意项 `t`，令 `P(t)` 为命题：“对于任意环境 `ρ`，`⟦ t ⟧_ρ` 的计算终止，且其结果是一个唯一的、属于 `V` 的元素。”

**1. 基础情况 (Base Cases)**
*   若 `t` 是常量 `()` 或 `⊥`：根据定义 3.3，`⟦ t ⟧_ρ` 的值就是该常量本身。计算立即终止，结果是唯一的，且根据定义 3.1，`t ∈ V`。故 `P(t)` 成立。
*   若 `t` 是变量 `s ∈ S`：根据定义 3.3，`⟦ s ⟧_ρ = ρ(s)`。由于 `ρ` 是一个从 `S` 到 `V` 的全函数，其应用立即终止，对于给定的 `s`，结果 `ρ(s)` 是唯一的，且根据 `ρ` 的余定义域，`ρ(s) ∈ V`。故 `P(s)` 成立。

**2. 归纳步骤 (Inductive Step)**
考虑复合项 `t = (t₁ := t₂)`。
**归纳假设 (IH)**: 假设 `P(t₁)` 和 `P(t₂)` 成立。即，对于任意 `ρ`，`⟦ t₁ ⟧_ρ` 和 `⟦ t₂ ⟧_ρ` 的计算终止，其结果分别为 `v₁` 和 `v₂`，且 `v₁, v₂` 是唯一的、属于 `V` 的值。

**归纳目标**: 证明 `P((t₁ := t₂))` 成立。
根据定义 3.3，计算 `⟦ (t₁ := t₂) ⟧_ρ` 的第一步是计算 `v₁` 和 `v₂`。根据归纳假设，这一步终止并得到唯一的 `v₁, v₂ ∈ V`。
接下来，求值函数根据 `v₁` 和 `v₂` 的值，应用定义 3.3(4) 中四个互斥且完备的规则之一来确定最终结果：
*   **情况 1**: 若 `v₁ ≡ v₂`，结果为 `()`。该结果是唯一的，且 `() ∈ V`。
*   **情况 2**: 若 `v₁ ≢ v₂` 且 `v₂ ≡ ()`，结果为 `v₁`。根据归纳假设，`v₁` 是唯一的且 `v₁ ∈ V`。
*   **情况 3**: 若 `v₁ ≡ ()` 且 `v₂ ≡ ⊥`，结果为 `⊥`。该结果是唯一的，且 `⊥ ∈ V`。
*   **情况 4**: 在其他所有情况下，结果为 `⟨v₁, v₂⟩`。根据归纳假设，`v₁` 和 `v₂` 是唯一的，因此构造出的有序对 `⟨v₁, v₂⟩` 也是唯一的。根据定义 3.1，`⟨v₁, v₂⟩ ∈ V`。

由于对于任何一对由归纳假设保证良定义的 `v₁, v₂`，都恰好匹配其中一个情况，并且每个情况都产生一个唯一的、属于 `V` 的值，因此命题 `P((t₁ := t₂))` 成立。

**结论**: 根据结构归纳法原理，命题 `P(t)` 对所有项 `t ∈ T` 均成立。因此，求值函数是良定义的。
■

**定理 4.1 (可靠性)**
若 `Γ ⊢ t₁ ~ t₂`，则 `Γ ⊨ t₁ ~ t₂`。

**证明**:
我们通过对推导 `Γ ⊢ t₁ ~ t₂` 的结构进行归纳。我们需要证明每个公理和推理规则都是可靠的，即如果其前提在语义上成立，则其结论也在语义上成立。

*   **(Reflexivity, Symmetry, Transitivity, Weakening, Hypothesis)**: 这些规则的可靠性直接源于 `≡` 作为等价关系的性质以及语义蕴含 `⊨` 的定义，其证明是标准的。

*   **(Congruence)**: 假设 `Γ ⊨ t₁ ~ s₁` 且 `Γ ⊨ t₂ ~ s₂`。取任意环境 `ρ` 使得 `ρ ⊨ Γ`。根据前提，`⟦ t₁ ⟧_ρ ≡ ⟦ s₁ ⟧_ρ` (记为 `v₁`) 和 `⟦ t₂ ⟧_ρ ≡ ⟦ s₂ ⟧_ρ` (记为 `v₂`)。`⟦ (t₁ := t₂) ⟧_ρ` 的值完全由 `v₁` 和 `v₂` 决定。同理，`⟦ (s₁ := s₂) ⟧_ρ` 的值也由相同的 `v₁` 和 `v₂` 决定。因此，`⟦ (t₁ := t₂) ⟧_ρ ≡ ⟦ (s₁ := s₂) ⟧_ρ`。故 `Γ ⊨ (t₁ := t₂) ~ (s₁ := s₂)`。

*   **(Def-Reflection)**: 假设 `Γ ⊨ t₁ ~ t₂`。取任意 `ρ` 使 `ρ ⊨ Γ`。则 `⟦ t₁ ⟧_ρ ≡ ⟦ t₂ ⟧_ρ`。根据语义求值定义 3.3(4) 的第一条规则，当 `v₁ ≡ v₂` 时，`⟦(t₁ := t₂)⟧_ρ` 的结果为 `()`。而 `⟦ () ⟧_ρ = ()`。因此 `ρ ⊨ (t₁ := t₂) ~ ()`。

*   **(Def-Elim)**: 假设 `Γ ⊨ (t₁ := t₂) ~ ()`。取任意 `ρ` 使 `ρ ⊨ Γ`。则 `⟦(t₁ := t₂)⟧_ρ ≡ ()`。考察定义 3.3(4) 的四种情况，唯一能产生 `()` 结果的是第一种情况，其条件是 `⟦ t₁ ⟧_ρ ≡ ⟦ t₂ ⟧_ρ`。因此 `ρ ⊨ t₁ ~ t₂`。

*   **(Reif)**: 需证 `⊨ t ~ (t := ())`。取任意环境 `ρ`，令 `v = ⟦ t ⟧_ρ`。计算 `⟦ (t := ()) ⟧_ρ`，其子项的值为 `v₁ = v` 和 `v₂ = ()`。
    1.  **情况 A**: 若 `v ≡ ()`。此时 `v₁ ≡ v₂`，根据求值规则第一条，`⟦ (t := ()) ⟧_ρ` 的结果为 `()`。在此情况下，`⟦ t ⟧_ρ ≡ ()` 与 `⟦ (t := ()) ⟧_ρ ≡ ()` 相同。
    2.  **情况 B**: 若 `v ≢ ()`。此时 `v₁ ≢ v₂` 且 `v₂ ≡ ()`，根据求值规则第二条，`⟦ (t := ()) ⟧_ρ` 的结果为 `v₁`，即 `v`。在此情况下，`⟦ t ⟧_ρ ≡ v` 与 `⟦ (t := ()) ⟧_ρ ≡ v` 相同。
    这两个情况覆盖了 `v` 的所有可能性。在所有情况下，`⟦ t ⟧_ρ ≡ ⟦ (t := ()) ⟧_ρ` 均成立。故 `⊨ t ~ (t := ())`。


* **(Def-Absurdity)**: **规则**: $\dfrac{}{\Gamma, x \sim (x := \bot) \vdash \bot \sim ()}$。**待证**: $\Gamma, x \sim (x := \bot) \models \bot \sim ()$

	* **证明**（形式化、按反证与情况划分）：
	
	1. 按语义蕴含的定义，我们需证明：任取环境 $\rho:\mathcal S\to V$，若 $\rho\models\Gamma\cup\{x\sim(x:=\bot)\}$，则 $\rho\models\bot\sim()$。
	
	2. 由于 $\rho\models\Gamma\cup\{x\sim(x:=\bot)\}$ 等价于（且含有）$\rho\models x\sim(x:=\bot)$，因此充分证明对任意环境 $\rho$ 都不可能有 $\rho\models x\sim(x:=\bot)$。若能证明对任意 $\rho$ 命题 $\rho\models x\sim(x:=\bot)$ 为假，则蕴含命题自动成立（空洞真）。
	
	3. 设任给环境 $\rho$，记 $v := \rho(x)\in V$。我们考察等式
	
	$$
	
	⟦ x⟧_\rho \equiv ⟦ (x:=\bot)⟧_\rho,
	
	$$
	
	即 $v \equiv ⟦ (x:=\bot)⟧_\rho$。按求值定义 3.3(4)（将 $t_1=x,t_2=\bot$ 代入）可进行以下穷尽的情况分析（这四种情形互斥且穷尽——见附录中对互斥完备性的说明）：
	
	* **情况 I**：若 $v \equiv \bot$。
	
	则按照求值规则第 1 条（当 $v_1\equiv v_2$ 时 $⟦(t_1:=t_2)⟧ = ()$），我们有 $⟦ (x:=\bot)⟧_\rho = ()$。于是等式 $v \equiv ⟦(x:=\bot)⟧_\rho$ 变为 $\bot \equiv ()$，这与定义 3.1 中 $ \bot$ 与 $()$ 为不同原子值的事实矛盾。因此情形 I 不可能。
	
	* **情况 II**：若 $v \equiv ()$。
	
	则按求值规则第 3 条（若 $v_1\equiv ()$ 且 $v_2\equiv\bot$，则 $⟦(t_1:=t_2)⟧=\bot$），我们有 $⟦ (x:=\bot)⟧_\rho = \bot$。于是等式变为 $() \equiv \bot$，同样矛盾。因此情形 II 也不可能。
	
	* **情况 III**：若 $v$ 既不等于 $()$ 也不等于 $\bot$。
	
	则按求值规则第 4 条（“其他所有情况”），$⟦ (x:=\bot)⟧_\rho = \langle v,\bot\rangle$（一个滞留对）。于是等式变为
	
	$$
	
	v \equiv \langle v,\bot\rangle.
	
	$$
	
	在附录中（命题 A.3）我们证明了：对任意 $v\in V$，不可能有 $v \equiv \langle v,\bot\rangle$（该命题由对 $V$ 的秩函数的简单秩不等式导出——见附录命题与证明）。因此情形 III 也导致矛盾。
	
	1. 由上三种情形的穷尽性与每一情形都导致矛盾，我们得出结论：不存在环境 $\rho$ 使 $\rho\models x\sim(x:=\bot)$。因此集合 $\{\rho\mid\rho\models x\sim(x:=\bot)\}$ 为空集。
	
	2. 所以对于任意环境 $\rho$，命题 “若 $\rho\models\Gamma\cup\{x\sim(x:=\bot)\}$ 则 $\rho\models\bot\sim()$” 都成立（前件恒为假，蕴含空洞为真）。于是 $\Gamma\cup\{x\sim(x:=\bot)\}\models\bot\sim()$ 成立，证明完毕。∎
	
	**备注**：该证明的关键环节是情形 III 中使用的秩不等式（附录命题 A.3）。为使论证完全自洽，下文把秩的形式定义与关于 $V$ 的无环 / 良基性证明给出，作为支撑材料。

由于推导中的每个公理和推理规则都是可靠的，那么通过这些规则从有效前提得到的任何结论也必然是有效的。因此，整个推导过程是可靠的。
■

### **第 5 节 系统一致性 (Consistency)**

**定理 5.1 (一致性)**
SDT 系统是一致的。

**证明**: 一个形式系统是一致的，当且仅当并非所有合法的判断都是可证的。我们将通过证明存在一个不可证的判断 `⊢ ⊥ ~ ()` 来证明系统的一致性（`⊢` 表示从空上下文 `Γ = ∅` 推导）。

1.  根据**可靠性定理 (定理 4.1)**，若 `⊢ ⊥ ~ ()`，则 `⊨ ⊥ ~ ()`。
2.  其逆否命题为：若 `⊭ ⊥ ~ ()`，则 `⊬ ⊥ ~ ()`。
3.  我们考察判断 `⊥ ~ ()` 的语义有效性。
    *   根据定义 3.3，对于任何环境 `ρ`，`⟦ ⊥ ⟧_ρ = ⊥`。
    *   根据定义 3.3，对于任何环境 `ρ`，`⟦ () ⟧_ρ = ()`。
4.  在我们的语义域 `V` 的构造中 (定义 3.1)，`⊥` 和 `()` 是两个不同的原子值。因此，`⟦ ⊥ ⟧_ρ ≢ ⟦ () ⟧_ρ`。
5.  根据**环境满足 (定义 3.4)** 的定义，不存在任何环境 `ρ` 满足 `ρ ⊨ ⊥ ~ ()`。因此，`⊭ ⊥ ~ ()`。
6.  根据可靠性定理的逆否命题，我们得出结论：`⊬ ⊥ ~ ()`。
7.  因为存在一个从空上下文中不可被证明的判断，所以 SDT 系统是一致的。**证毕。****


---

## 附录：秩的形式化定义与 $V$ 的无环（良基）证明

下面我们**严格定义秩函数**并证明若干引理，以备在主文中引用（特别是用于 Def-Absurdity 的情形 III）。

#### A.0 预备说明（重复定义以便自包含）

回顾语义域的分层定义（与主文一致）：

$$

\begin{aligned}

V_0 &:= \{\,(),\bot\,\},\\

V_{n+1} &:= V_0 \;\cup\; (V_n\times V_n),\qquad\text{对任意 } n\ge 0,\\

V &:= \bigcup_{n=0}^\infty V_n.

\end{aligned}

$$

这里 $V_n\times V_n$ 表示按“滞留对”构造得到的有序对集合的集合——也即如果 $a,b\in V_n$ 则构造有 $\langle a,b\rangle\in V_{n+1}$。常量 $()$ 与 $\bot$ 属于 $V_0$。

> 说明（关于术语）：“滞留对”记作 $\langle a,b\rangle$；这是语义层面的构造值，不与语法上的括号混淆（语法项仍写作 $(t_1:=t_2)$）。

#### A.1 秩（rank）的定义

**定义 A.1（秩）**

对任意 $v\in V$，定义其秩 $\mathrm{rk}(v)$ 为使得

$$

\mathrm{rk}(v) := \min\{\, n\in\mathbb N \mid v\in V_n\,\}.

$$

（该最小值存在并且是有限的，因为 $v\in V\Rightarrow v\in V_N$ 对某 $N$ 成立；我们在下文将证明该最小性的一些性质。）

#### A.2 有关秩的基本引理

**引理 A.2.1（基底元素的秩）**

对常量 $()$ 与 $\bot$，有 $\mathrm{rk}(() ) = \mathrm{rk}(\bot) = 0$。

*证明*：显然 $(),\bot\in V_0$ 且 $V_{-1}$ 未定义，故最小 $n$ 为 $0$。∎

**引理 A.2.2（对构造与秩）**

若 $a,b\in V$，则

$$

\mathrm{rk}(\langle a,b\rangle) = \max\big(\mathrm{rk}(a),\mathrm{rk}(b)\big) + 1.

$$

*证明*：令 $m=\max(\mathrm{rk}(a),\mathrm{rk}(b))$。

由定义 $\mathrm{rk}(a)\le m$ 且 $\mathrm{rk}(b)\le m$，因此 $a,b\in V_m$。由 $V_{m+1}=V_0\cup(V_m\times V_m)$ 可知 $\langle a,b\rangle\in V_{m+1}$，所以 $\mathrm{rk}(\langle a,b\rangle)\le m+1$。

要证明不可能有更小的秩，即不能有 $\langle a,b\rangle\in V_k$ 对某 $k\le m$。若 $k\le m$ 且 $\langle a,b\rangle\in V_k$，则按分层定义只能发生两种情形之一：要么 $k=0$ 且 $\langle a,b\rangle\in V_0=\{(),\bot\}$（但显然 $\langle a,b\rangle$ 不是原子值），要么 $\langle a,b\rangle\in V_j\times V_j$ 对某 $j<k$（更精确地，$V_{k}=V_0\cup(V_{k-1}\times V_{k-1})$），这蕴含 $a,b\in V_{k-1}$。由 $k-1\le m-1 < m$ 我们得出 $\mathrm{rk}(a)\le k-1 \le m-1< m$，这与 $m=\max(\mathrm{rk}(a),\mathrm{rk}(b))$ 相矛盾。形式化地，可用对 $m$ 的最小性作反证得到不可能。因此 $\mathrm{rk}(\langle a,b\rangle)=m+1$。∎

**推论 A.2.3（秩严格下降）**

对于任意 $a,b\in V$，有

$$

\mathrm{rk}(\langle a,b\rangle) > \mathrm{rk}(a)\quad\text{且}\quad \mathrm{rk}(\langle a,b\rangle) > \mathrm{rk}(b).

$$

这是上一个引理的直接结论（加一运算保证严格大于）。

#### A.3 与“自指等式”相关的命题

**命题 A.3（不存在 $v$ 满足 $v=\langle v,\bot\rangle$）**

对任意 $v\in V$，不可能有 $v \equiv \langle v,\bot\rangle$。

*证明*：设反设存在 $v\in V$ 使得 $v=\langle v,\bot\rangle$。记 $r=\mathrm{rk}(v)$。考虑两种情况：

* 若 $r=0$。则 $v\in V_0$，因此 $v$ 为 $ ()$ 或 $\bot$。

* 若 $v=\bot$，则右边 $\langle v,\bot\rangle=\langle\bot,\bot\rangle$。按求值定义，此对属于 $V_1$ 且不是 $\bot$（亦非 $()$），因此 $\bot\neq\langle\bot,\bot\rangle$。矛盾。

* 若 $v=()$，则右边 $\langle (),\bot\rangle\in V_1$ 且不是 $()$，矛盾。

* 若 $r\ge 1$。则由定义存在 $r-1$ 使得 $v\in V_r\setminus V_{r-1}$。按引理 A.2.2 有

$$

\mathrm{rk}(\langle v,\bot\rangle) = \max(\mathrm{rk}(v),\mathrm{rk}(\bot)) + 1 = \max(r,0) + 1 = r+1.

$$

因此 $\mathrm{rk}(\langle v,\bot\rangle)=r+1\ne r=\mathrm{rk}(v)$。既然秩不同，二者不能相等（秩是由分层定义的最小层数），矛盾。

两种情形均矛盾，故不存在此类 $v$。∎

#### A.4 关于 $V$ 的良基（well-foundedness / 无环性）

为精确说明“无环”或“良基”我们采用**值的“子值（subvalue）”关系**来表述（这比直接使用集合论中的 $\in$ 更贴合我们用分层构造描述的语义域）：

**定义 A.4（立即子值与子值序列）**

对 $u,v\in V$，称 $u$ 为 $v$ 的**立即子值**（记作 $u\prec_1 v$）当且仅当 $v$ 是一个滞留对且 $v=\langle a,b\rangle$ 同时 $u=a$ 或 $u=b$。把 $\prec$ 定义为 $\prec$ 的传递闭包（即存在 $n\ge1$ 使 $u\prec_1 w_1\prec_1\cdots\prec_1 v$），称之为\*\*（可达的）子值关系\*\*。

**命题 A.4.1（秩沿子值链严格下降）**

若 $u\prec_1 v$，则 $\mathrm{rk}(u) < \mathrm{rk}(v)$。因而若 $u\prec v$（存在若干步的立即子值链），则 $\mathrm{rk}(u) < \mathrm{rk}(v)$。

*证明*：若 $u\prec_1 v$，则 $v=\langle a,b\rangle$ 且 $u\in\{a,b\}$. 由引理 A.2.2 与推论 A.2.3，得 $\mathrm{rk}(v) = \max(\mathrm{rk}(a),\mathrm{rk}(b)) + 1$。于是 $\mathrm{rk}(u)\le\max(\mathrm{rk}(a),\mathrm{rk}(b))<\mathrm{rk}(v)$。若 $u\prec v$ 为多步链，则沿链每一步秩都严格下降，合并得 $\mathrm{rk}(u) < \mathrm{rk}(v)$。∎

**定理 A.4.2（子值关系良基性 ⇒ 无无限下降链）**

不存在无限的下降链

$$

v_0 \succ v_1 \succ v_2 \succ \cdots

$$

其中每一步均按子值关系（$\succ$ 为 $\prec$ 的逆）。换言之，$(V,\prec)$ 是良基的：任何非空子集在 $\prec$ 下都有最小元。

*证明*：若存在无限下降链 $v_0\succ v_1\succ v_2\succ\cdots$，则按命题 A.4.1 有

$$

\mathrm{rk}(v_0)>\mathrm{rk}(v_1)>\mathrm{rk}(v_2)>\cdots,

$$

从而得到一个在自然数上的无限严格下降链，这不可能（自然数良序性）。矛盾，因此不存在这样的无限下降链。∎

**结论 A.4.3（$V$ 的良基性 / 无环性）**

在以上意义下，$V$ 对于“子值”关系是良基的；特别地，不存在 $v\in V$ 使得 $v\prec v$（即没有“自包含”作为自己子值的情形），从而也排除了诸如 $v=\langle v,\bot\rangle$ 之类的自指结构（命题 A.3 的结论）。

好的。

---

## **元定理：定义性外延定理 (Definitional Extensionality Theorem)**

**定理陈述**

对于任意上下文 `Γ` 以及任意项 `t₁`, `t₂`，以下判断等价：
$$ \Gamma \vdash (t_1 := ()) \sim (t_2 := ()) \quad \Longleftrightarrow \quad \Gamma \vdash t_1 \sim t_2 $$

**证明**

为了证明该当且仅当关系，我们分别证明两个方向的蕴含。

**第一部分 (⇒)：** 证明若 `Γ ⊢ (t₁ := ()) ~ (t₂ := ())`，则 `Γ ⊢ t₁ ~ t₂`。

1.  `Γ ⊢ (t₁ := ()) ~ (t₂ := ())`  (假设)
2.  `Γ ⊢ t₁ ~ (t₁ := ())`  (公理 **Reif**)
3.  `Γ ⊢ t₂ ~ (t₂ := ())`  (公理 **Reif**)
4.  `Γ ⊢ (t₂ := ()) ~ t₂`  (由 (3) 和规则 **Symmetry**)
5.  `Γ ⊢ t₁ ~ (t₂ := ())`  (由 (2), (1) 和规则 **Transitivity**)
6.  `Γ ⊢ t₁ ~ t₂`  (由 (5), (4) 和规则 **Transitivity**)

此方向证明完毕。

**第二部分 (⇐)：** 证明若 `Γ ⊢ t₁ ~ t₂`，则 `Γ ⊢ (t₁ := ()) ~ (t₂ := ())`。

1.  `Γ ⊢ t₁ ~ t₂`  (假设)
2.  `Γ ⊢ () ~ ()`  (公理 **Reflexivity**)
3.  `Γ ⊢ (t₁ := ()) ~ (t₂ := ())`  (由 (1), (2) 和规则 **Congruence**)

此方向证明完毕。

**结论**

由于双向蕴含均已得证，该定理成立。
■