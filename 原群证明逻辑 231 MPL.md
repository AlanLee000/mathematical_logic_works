### **原群证明逻辑 (Magmatic Proof Logic, MPL): 形式化规范**

#### **第 1 节 语法 (Syntax)**

**定义 1.1 (字母表)**
系统的字母表 $\Sigma$ 由以下不相交的集合构成：

1.  一个可数的**变量符号集** $\mathcal{V} = \{x, y, z, ...\}$。
2.  一个包含两个**常量符号**的集合 $\mathcal{C} = \{T, \bot\}$。
3.  一个包含二元**组合构造子**的集合 $\{\cdot\}$。
4.  一个包含二元**等价构造子**的集合 $\{\text{equiv}\}$。
5.  一个包含一元**引用构造子**的集合 $\{\text{Quote\}}$。   
6.  辅助符号 `(`, `)`。

**定义 1.2 (项)**
项的集合 $\mathcal{T}$ 是满足以下条件的最小集合：

1.  **原子项**: 若 $v \in \mathcal{V}$ 或 $c \in \mathcal{C}$，则 $v$ 和 $c$ 都是项。
2.  **复合项**: 若 $t_1, t_2 \in \mathcal{T}$，则以下表达式也是项：
    *   `(· t₁ t₂)`  (组合项)
    *   `(equiv t₁ t₂)` (等价项)
    *    `(Quote t₁)` (引用项)

*我们使用S-表达式风格的前缀表示法。*

**定义 1.3 (判断)**
系统中唯一的一种判断形式是**可证等价判断**，其形式为 `t₁ ≡ t₂`，其中 $t_1, t_2 \in \mathcal{T}$。

---

#### **第 2 节 证明论 (Proof Theory)**

一个判断 `t₁ ≡ t₂` 是可证的（记为 `⊢ t₁ ≡ t₂`），当且仅当它可以从以下公理模式和推理规则推导得出。

##### **A. 结构与同余规则 (Structural and Congruence Rules)**

这些规则确保 `≡` 是一个同余关系。

*   **(Reflexivity)**: $\dfrac{}{\vdash t \equiv t}$
*   **(Symmetry)**: $\dfrac{\vdash t_1 \equiv t_2}{\vdash t_2 \equiv t_1}$
*   **(Transitivity)**: $\dfrac{\vdash t_1 \equiv t_2 \quad \vdash t_2 \equiv t_3}{\vdash t_1 \equiv t_3}$
*   **(Congruence)**: $\dfrac{\vdash t_1 \equiv s_1 \quad \vdash t_2 \equiv s_2}{\vdash (· \ t_1 \ t_2) \equiv (· \ s_1 \ s_2) \qquad \vdash (Quote\ t_1 ) \equiv (Quote \ s_1) \qquad \vdash (\text{equiv } t_1 \ t_2) \equiv (\text{equiv } s_1 \ s_2)}$

##### **B. 计算与数据公理 (Axioms of Computation and Data)**

*   **公理 B1 (真即计算 / Truth as Computation):**
    ```
    ⊢ (· t T) ≡ t
    ```
    *释义：常量 `T` 作为组合运算 `·` 的右单位元。将其应用于任何项 `t`，都会“执行”一个保持 `t` 不变的计算。*
*   **公理 B2 (求值规则)**:
    ```
    若 ⊢ t₁ ≡ (Quote t₂)
    --------------------
    则 ⊢ (· T t₁) ≡ t₂
    ```

##### **C. 引用与矛盾公理 (Axioms of Quotation and Contradiction)**

*   **公理 C1 (矛盾的引用 / Quote of Contradiction):**
    ```
    ⊢ (Quote ⊥) ≡ ⊥
    ```
    *释义：对矛盾 `⊥` 的引用操作，其结果仍然是矛盾 `⊥` 本身。这直接形式化了思想 3：“矛盾的引用还是矛盾”。*

*   **公理 C2 (忠实引用 / Faithful Quotation):**
    ```
    ⊢ (· (Quote t) t) ≡ T
    ```
    *释义：将一个项 `t` 的引用 `(Quote t)` 应用于 `t` 本身，这个行为在系统内被断言为真 `T`。

*   **规则 C3 (爆炸规则 / Rule of Explosion):**
	```
	若 ⊢ t ≡ T
	----------- (C3-Rule)
	则 ⊢ (· ⊥ t) ≡ ⊥
	```
    *释义：矛盾范式具有“污染性”，任何与之通过 `·` 运算结合的真的项都会坍缩为矛盾本身。*

##### **D. 原群证明公理 (Axioms of Magmatic Proof)**

这组公理是 MPL 的核心，它们将证明论的概念内化为对象级的代数运算。

*   **公理 D1 (证明之内在反射性 / Internal Reflexivity of Proof):**
    ```
    ⊢ (equiv t t) ≡ T
    ```
    *释义：一个证明“t 等价于其自身”的路径，其本身的计算结果就是真理、同时也是计算行为 `T`。*


*   **公理 D2 (证明之内在传递性 / Internal Transitivity of Proof):**
    ```
    ⊢ (· (equiv t₁ t₂) (equiv t₂ t₃)) ≡ (equiv t₁ t₃)
    ```
    *释义：将从 `t₁`到`t₂` 的证明路径与从 `t₂`到`t₃` 的证明路径进行组合运算，其结果等价于一条从 `t₁`到`t₃` 的直接证明路径。*

---

#### **第 3 节 形式语义与一致性证明**

本节为原群证明逻辑 (MPL) 引入一个形式化的代数语义，并以此为基础证明其可靠性 (Soundness)，最终推导出系统的一致性 (Consistency)。

##### **定义 3.1 (MPL 模型)**

一个 MPL 模型是一个偶对 $\mathcal{M} = \langle D, I \rangle$，其中：

1.  $D$ 是一个非空的集合，称为模型的**域 (Domain)**。
2.  $I$ 是一个**解释函数 (Interpretation Function)**，它将字母表 $\Sigma$ 中的符号映射到 $D$ 上的语义对象。

具体地，我们构造一个特定的模型 $\mathcal{M}_{\text{MPL}} = \langle D, I \rangle$ 如下：

1.  **域**: $D = \{v_T, v_\bot\}$，其中 $v_T \neq v_\bot$。

2.  **解释函数**: $I$ 的定义如下：
    *   对于常量符号 $c \in \mathcal{C}$：
        *   $I(T) = v_T$
        *   $I(\bot) = v_\bot$
    *   对于函数符号 $f \in \{\cdot, \text{equiv}, \text{Quote}\}$：
        *   $I(\cdot) = \text{dot}: D \times D \to D$
        *   $I(\text{equiv}) = \text{equiv}_{fn}: D \times D \to D$
        *   $I(\text{Quote}) = \text{quote}_{fn}: D \to D$

    这些函数的具体定义如下：

    a.  **`quote_fn`**: `quote_fn` 是 $D$ 上的恒等函数。
        *   `quote_fn`(d) = d

    b.  **`equiv_fn`**: `equiv_fn` 是 $D$ 上的等价性测试函数。
        *   `equiv_fn`(d₁, d₂) = $v_T$ 若 $d_1 = d_2$
        *   `equiv_fn`(d₁, d₂) = $v_\bot$ 若 $d_1 \neq d_2$

    c.  **`dot`**: `dot` 函数由下表定义：

| `dot(d₁, d₂)` | `d₂ = v_T` | `d₂ = v_⊥` |
| :------------ | :--------- | :--------- |
| **`d₁ = v_T`**  | `v_T`      | `v_⊥`      |
| **`d₁ = v_⊥`**  | `v_⊥`      | `v_T`      |

##### **定义 3.2 (项的解释与判断的有效性)**

1.  **变量赋值 (Variable Assignment)**: 一个变量赋值是一个函数 $\sigma: \mathcal{V} \to D$。

2.  **项的解释 (Term Interpretation)**: 对于任意项 $t \in \mathcal{T}$ 和变量赋值 $\sigma$，其解释 $[[t]]^\sigma \in D$ 按如下方式递归定义：
    *   若 $v \in \mathcal{V}$，则 $[[v]]^\sigma = \sigma(v)$。
    *   若 $c \in \mathcal{C}$，则 $[[c]]^\sigma = I(c)$。
    *   $[[(· \ t_1 \ t_2)]]^\sigma = I(\cdot)([[t_1]]^\sigma, [[t_2]]^\sigma) = \text{dot}([[t_1]]^\sigma, [[t_2]]^\sigma)$。
    *   $[[(equiv \ t_1 \ t_2)]]^\sigma = I(\text{equiv})([[t_1]]^\sigma, [[t_2]]^\sigma) = \text{equiv}_{fn}([[t_1]]^\sigma, [[t_2]]^\sigma)$。
    *   $[[(Quote \ t_1)]]^\sigma = I(\text{Quote})([[t_1]]^\sigma) = \text{quote}_{fn}([[t_1]]^\sigma)$。

3.  **判断的有效性 (Validity of a Judgement)**: 一个判断 $t_1 \equiv t_2$ 在模型 $\mathcal{M}_{\text{MPL}}$ 中是有效的，记作 $\mathcal{M}_{\text{MPL}} \models t_1 \equiv t_2$，当且仅当对于**所有**的变量赋值 $\sigma: \mathcal{V} \to D$，都有 $[[t_1]]^\sigma = [[t_2]]^\sigma$。

##### **定理 3.3 (可靠性 / Soundness)**

对于任意项 $t_1, t_2 \in \mathcal{T}$，若 $\vdash t_1 \equiv t_2$，则 $\mathcal{M}_{\text{MPL}} \models t_1 \equiv t_2$。

**证明**:
在验证公理的有效性时，必须注意所有公理（如 B1, C1, C2, D1, D2）都是**公理模式 (axiom schemas)**，它们对任意项 $t, t_1, t_2, \dots$ 成立。因此，证明其在模型 $\mathcal{M}_{\text{MPL}}$ 中有效，意味着需要证明对于**任意**变量赋值 $\sigma$，该公理模式实例化后的等式在语义上成立。下文的证明将遵循此原则。

*   **A组：结构与同余规则**:
    *   **自反性、对称性、传递性**: `≡` 在模型中的语义对应于 $D$ 上的等号 ` = `，而 ` = ` 是一个标准的等价关系。因此这些规则是保真的。
	*   **同余性**: 此规则的保真性源于模型中语义函数的良定义性。语义函数 $\text{dot}$, $\text{equiv}_{fn}$, $\text{quote}_{fn}$ 均为确定的（total）函数。以组合构造子 `·` 为例，我们需要证明：若 $\mathcal{M}_{\text{MPL}} \models t_1 \equiv s_1$ 且 $\mathcal{M}_{\text{MPL}} \models t_2 \equiv s_2$，则 $\mathcal{M}_{\text{MPL}} \models (· \ t_1 \ t_2) \equiv (· \ s_1 \ s_2)$。
	    *   前提意味着，对任意赋值 $\sigma$，有 $[[t_1]]^\sigma = [[s_1]]^\sigma$ 且 $[[t_2]]^\sigma = [[s_2]]^\sigma$。
	    *   由于 $\text{dot}$ 是一个函数，当其输入相同时，其输出必然相同。因此：
	        $$ \text{dot}([[t_1]]^\sigma, [[t_2]]^\sigma) = \text{dot}([[s_1]]^\sigma, [[s_2]]^\sigma) $$
	    *   根据项的解释定义，这等价于 $[[(· \ t_1 \ t_2)]]^\sigma = [[(· \ s_1 \ s_2)]]^\sigma$。
	    *   此等式对所有 $\sigma$ 成立，故 $\mathcal{M}_{\text{MPL}} \models (· \ t_1 \ t_2) \equiv (· \ s_1 \ s_2)$。
	    *   对 `equiv` 和 `Quote` 构造子的同余规则可由完全相同的推理得出。因此，同余规则是保真的。

*   **B组：计算与数据公理**:
    *   **公理 B1**: 需证 $\mathcal{M}_{\text{MPL}} \models (· \ t \ T) \equiv t$。即对任意 $\sigma$，$[[(· \ t \ T)]]^\sigma = [[t]]^\sigma$。
        LHS = $\text{dot}([[t]]^\sigma, [[T]]^\sigma) = \text{dot}([[t]]^\sigma, v_T)$。根据 `dot` 的定义，此式等于 $[[t]]^\sigma$ = RHS。公理有效。
    *   **规则 B2**: 假设前提 $\mathcal{M}_{\text{MPL}} \models t_1 \equiv (Quote \ t_2)$ 成立。这意味着对任意 $\sigma$, $[[t_1]]^\sigma = [[(Quote \ t_2)]]^\sigma = \text{quote}_{fn}([[t_2]]^\sigma) = [[t_2]]^\sigma$。
        需证结论 $\mathcal{M}_{\text{MPL}} \models (· \ T \ t_1) \equiv t_2$。
        LHS = $[[(· \ T \ t_1)]]^\sigma = \text{dot}([[T]]^\sigma, [[t_1]]^\sigma) = \text{dot}(v_T, [[t_1]]^\sigma)$。根据 `dot` 的定义，此式等于 $[[t_1]]^\sigma$。由前提知，这等于 $[[t_2]]^\sigma$ = RHS。规则保真。

*   **C组：引用与矛盾公理**:
    *   **公理 C1**: 需证 $\mathcal{M}_{\text{MPL}} \models (Quote \ \bot) \equiv \bot$。
        LHS = $[[(Quote \ \bot)]]^\sigma = \text{quote}_{fn}([[\bot]]^\sigma) = \text{quote}_{fn}(v_\bot) = v_\bot$。RHS = $[[\bot]]^\sigma = v_\bot$。公理有效。
    *   **公理 C2**: 需证 $\mathcal{M}_{\text{MPL}} \models (· \ (Quote \ t) \ t) \equiv T$。
        LHS = $\text{dot}([[(Quote \ t)]]^\sigma, [[t]]^\sigma) = \text{dot}(\text{quote}_{fn}([[t]]^\sigma), [[t]]^\sigma) = \text{dot}([[t]]^\sigma, [[t]]^\sigma)$。
        令 $d = [[t]]^\sigma$。若 $d=v_T$，LHS = $\text{dot}(v_T, v_T) = v_T$。若 $d=v_\bot$，LHS = $\text{dot}(v_\bot, v_\bot) = v_T$。在所有情况下，LHS 均为 $v_T = [[T]]^\sigma$ = RHS。公理有效。
    *   **规则 C3**: 假设前提 $\mathcal{M}_{\text{MPL}} \models t \equiv T$ 成立，即对任意 $\sigma$, $[[t]]^\sigma = v_T$。
        需证结论 $\mathcal{M}_{\text{MPL}} \models (· \ \bot \ t) \equiv \bot$。
        LHS = $[[(· \ \bot \ t)]]^\sigma = \text{dot}([[\bot]]^\sigma, [[t]]^\sigma) = \text{dot}(v_\bot, v_T) = v_\bot = [[\bot]]^\sigma$ = RHS。规则保真。

*   **D组：原群证明公理**:
    *   **公理 D1**: 需证 $\mathcal{M}_{\text{MPL}} \models (equiv \ t \ t) \equiv T$。
        LHS = $[[(equiv \ t \ t)]]^\sigma = \text{equiv}_{fn}([[t]]^\sigma, [[t]]^\sigma)$。根据 `equiv_fn` 定义，此式恒为 $v_T = [[T]]^\sigma$ = RHS。公理有效。
    *   **公理 D2**: 需证 $\mathcal{M}_{\text{MPL}} \models (· \ (equiv \ t_1 \ t_2) \ (equiv \ t_2 \ t_3)) \equiv (equiv \ t_1 \ t_3)$。
        令 $d_1=[[t_1]]^\sigma, d_2=[[t_2]]^\sigma, d_3=[[t_3]]^\sigma$。需证 $\text{dot}(\text{equiv}_{fn}(d_1, d_2), \text{equiv}_{fn}(d_2, d_3)) = \text{equiv}_{fn}(d_1, d_3)$。
        我们对 $d_1, d_2, d_3$ 之间的相等关系进行分情况讨论：
        1.  $d_1 = d_2, d_2 = d_3$ (因此 $d_1 = d_3$): LHS = $\text{dot}(v_T, v_T) = v_T$。RHS = $\text{equiv}_{fn}(d_1, d_1) = v_T$。LHS = RHS。
        2.  $d_1 = d_2, d_2 \neq d_3$ (因此 $d_1 \neq d_3$): LHS = $\text{dot}(v_T, v_\bot) = v_\bot$。RHS = $\text{equiv}_{fn}(d_1, d_3) = v_\bot$。LHS = RHS。
        3.  $d_1 \neq d_2, d_2 = d_3$ (因此 $d_1 \neq d_3$): LHS = $\text{dot}(v_\bot, v_T) = v_\bot$。RHS = $\text{equiv}_{fn}(d_1, d_3) = v_\bot$。LHS = RHS。
		4.  $d_1 \neq d_2$ 且 $d_2 \neq d_3$：我们在此利用模型的域 $D = \{v_T, v_\bot\}$ 只有两个元素这一事实。给定三个值 $d_1, d_2, d_3$，根据鸽巢原理，它们之中必有重复。若 $d_1 \neq d_2$ 且 $d_2 \neq d_3$，则必然有 $d_1 = d_3$。因此此情况与情况 1 等价，只是 $d_2$ 取了与 $d_1, d_3$ 不同的值。
		    *   LHS = $\text{dot}(\text{equiv}_{fn}(d_1, d_2), \text{equiv}_{fn}(d_2, d_3)) = \text{dot}(v_\bot, v_\bot) = v_T$。
		    *   RHS = $\text{equiv}_{fn}(d_1, d_3) = \text{equiv}_{fn}(d_1, d_1) = v_T$。
		    *   LHS = RHS。

由于所有公理均有效，且所有推理规则均保真，可靠性定理得证。 Q.E.D.

##### **定理 3.4 (一致性 / Consistency)**

MPL 系统是一致的，即 $\nvdash T \equiv \bot$。

**证明**:
1.  采用反证法。假设 MPL 是不一致的，即 $\vdash T \equiv \bot$。
2.  根据**可靠性定理 (定理 3.3)**，若 $\vdash T \equiv \bot$，则 $\mathcal{M}_{\text{MPL}} \models T \equiv \bot$。
3.  根据**有效性的定义 (定义 3.2)**，$\mathcal{M}_{\text{MPL}} \models T \equiv \bot$ 意味着对所有变量赋值 $\sigma$，都有 $[[T]]^\sigma = [[\bot]]^\sigma$。
4.  根据**项的解释的定义 (定义 3.2)**，由于 $T$ 和 $\bot$ 是常量，它们的解释不依赖于 $\sigma$：
    *   $[[T]]^\sigma = I(T) = v_T$
    *   $[[\bot]]^\sigma = I(\bot) = v_\bot$
5.  因此，我们得到结论 $v_T = v_\bot$。
6.  然而，这与我们在**模型构造 (定义 3.1)** 中 $D$ 的定义相矛盾，该定义明确要求 $v_T \neq v_\bot$。
7.  此矛盾源于最初的假设，故该假设为假。

因此，MPL 系统是一致的。 Q.E.D.

---

### **第 4 节 商项代数语义与一致性**

在第 3 节中，我们通过构造一个具体的两元素模型 $\mathcal{M}_{\text{MPL}}$ 证明了系统的一致性。本节将引入一种不同的语义模型，它直接从 MPL 的句法和证明论规则中构建而来。这个模型被称为**商项代数模型 (Quotient Term Algebra Model)**，可视为系统的**典范模型 (Canonical Model)**，因为它忠实地反映了可证等价关系 `⊢` 所诱导的代数结构。我们将首先证明该模型的可靠性，然后利用它与 $\mathcal{M}_{\text{MPL}}$ 之间的联系，给出一致性的一个更具结构性的证明。

#### **定义 4.1 (商项代数模型)**

MPL 的**商项代数模型**，记作 $\mathcal{M}_{\text{term}} = \langle D_{\text{term}}, I_{\text{term}} \rangle$，其构造如下：

1.  **域 (Domain)**:
    *   根据第 2.A 节的结构规则，可证等价关系 `≡` 是一个在所有项的集合 $\mathcal{T}$ 上的等价关系（自反、对称、传递）。
    *   对于任意项 $t \in \mathcal{T}$，我们定义其**等价类**为 `[t] = {s ∈ T | ⊢ t ≡ s}`。
    *   模型的域 $D_{\text{term}}$ 是由 `≡` 关系导出的所有等价类的集合，即商集 $\mathcal{T}/\equiv$。
        $$D_{\text{term}} = \{[t] \mid t \in \mathcal{T}\}$$

2.  **解释函数 (Interpretation Function)**:
    *   $I_{\text{term}}$ 是一个将字母表 $\Sigma$ 中的符号映射到 $D_{\text{term}}$ 或 $D_{\text{term}}$ 上操作的函数。
    *   **常量符号**: 常量的解释是其自身的等价类。
        *   $I_{\text{term}}(T) = [T]$
        *   $I_{\text{term}}(\bot) = [\bot]$
    *   **函数符号**: 构造子的解释是在 $D_{\text{term}}$ 上的相应操作。对于任意 $[t_1], [t_2] \in D_{\text{term}}$：
        *   $I_{\text{term}}(\cdot) = \text{dot}_{\text{term}}([t_1], [t_2]) := [(· \ t_1 \ t_2)]$
        *   $I_{\text{term}}(\text{equiv}) = \text{equiv}_{\text{term}}([t_1], [t_2]) := [(\text{equiv } t_1 \ t_2)]$
        *   $I_{\text{term}}(\text{Quote}) = \text{quote}_{\text{term}}([t_1]) := [(\text{Quote } t_1)]$

**操作的良定义性 (Well-Definedness)**: 这些在等价类上定义的操作必须独立于代表元的选择。第 2.A 节的 **(Congruence)** 规则确保了这一点。我们逐一验证：

*   **对于 $\text{dot}_{\text{term}}$**: 假设 $[t_1] = [s_1]$ 且 $[t_2] = [s_2]$。根据等价类的定义，这意味着 $\vdash t_1 \equiv s_1$ 且 $\vdash t_2 \equiv s_2$。应用 `·` 的同余规则，我们推导出 $\vdash (· \ t_1 \ t_2) \equiv (· \ s_1 \ s_2)$。这反过来意味着 $[(· \ t_1 \ t_2)] = [(· \ s_1 \ s_2)]$。因此，$\text{dot}_{\text{term}}([t_1], [t_2]) = \text{dot}_{\text{term}}([s_1], [s_2])$，操作是良定义的。
*   **对于 $\text{equiv}_{\text{term}}$**: 假设 $[t_1] = [s_1]$ 且 $[t_2] = [s_2]$。同理，由 `equiv` 的同余规则可得 $\vdash (\text{equiv } t_1 \ t_2) \equiv (\text{equiv } s_1 \ s_2)$，即 $[(\text{equiv } t_1 \ t_2)] = [(\text{equiv } s_1 \ s_2)]$。操作是良定义的。
*   **对于 $\text{quote}_{\text{term}}$**: 假设 $[t_1] = [s_1]$。由 `Quote` 的同余规则可得 $\vdash (\text{Quote } t_1) \equiv (\text{Quote } s_1)$，即 $[(\text{Quote } t_1)] = [(\text{Quote } s_1)]$。操作是良定义的。

因此，模型 $\mathcal{M}_{\text{term}}$ 中的所有操作均是良定义的。

##### **定义 4.1.1 (并行替换 / Parallel Substitution)**

令 $S = \{s_1/x_1, \dots, s_n/x_n\}$ 为一个替换映射，其中 $x_i$ 是互不相同的变量，$s_i$ 是任意项。我们将项 $t$ 在 $S$ 下的**并行替换**记作 $t\{S\}$，其定义通过对 $t$ 的结构进行归纳来形式化：

1.  **变量 (Variable)**:
    *   若 $y \in \mathcal{V}$ 且 $y = x_i$ 对于某个 $i \in \{1, \dots, n\}$，则 $y\{S\} := s_i$。
    *   若 $y \in \mathcal{V}$ 且 $y \notin \{x_1, \dots, x_n\}$，则 $y\{S\} := y$。

2.  **常量 (Constant)**:
    *   若 $c \in \mathcal{C}$，则 $c\{S\} := c$。

3.  **复合项 (Compound Term)**:
    *   $(· \ t_1 \ t_2)\{S\} := (· \ t_1\{S\} \ t_2\{S\})$。
    *   $(\text{equiv } t_1 \ t_2)\{S\} := (\text{equiv } t_1\{S\} \ t_2\{S\})$。
    *   $(\text{Quote } t_1)\{S\} := (\text{Quote } t_1\{S\})$。

此定义明确了替换操作会递归地应用于项的所有子部分，并且对于 `Quote` 构造子，替换会穿透并作用于其内部的项。这为**引理 4.2.1 (替换引理)** 的归纳证明提供了坚实的形式化基础。

#### **定义 4.2 (项的解释与判断的有效性)**

1.  **变量赋值 (Variable Assignment)**: 一个变量赋值是一个函数 $\sigma: \mathcal{V} \to D_{\text{term}}$。

2.  **项的解释 (Term Interpretation)**: 对于任意项 $t \in \mathcal{T}$ 和变量赋值 $\sigma$，其解释 $[[t]]_{\text{term}}^\sigma \in D_{\text{term}}$ 按如下方式递归定义：
    *   若 $v \in \mathcal{V}$，则 $[[v]]_{\text{term}}^\sigma = \sigma(v)$。
    *   若 $c \in \mathcal{C}$，则 $[[c]]_{\text{term}}^\sigma = I_{\text{term}}(c) = [c]$。
    *   $[[(· \ t_1 \ t_2)]]_{\text{term}}^\sigma = \text{dot}_{\text{term}}([[t_1]]_{\text{term}}^\sigma, [[t_2]]_{\text{term}}^\sigma)$。
    *   $[[(equiv \ t_1 \ t_2)]]_{\text{term}}^\sigma = \text{equiv}_{\text{term}}([[t_1]]_{\text{term}}^\sigma, [[t_2]]_{\text{term}}^\sigma)$。
    *   $[[(Quote \ t_1)]]_{\text{term}}^\sigma = \text{quote}_{\text{term}}([[t_1]]_{\text{term}}^\sigma)$。

3.  **判断的有效性 (Validity of a Judgement)**: 一个判断 $t_1 \equiv t_2$ 在模型 $\mathcal{M}_{\text{term}}$ 中是有效的，记作 $\mathcal{M}_{\text{term}} \models t_1 \equiv t_2$，当且仅当对于**所有**的变量赋值 $\sigma: \mathcal{V} \to D_{\text{term}}$，都有 $[[t_1]]_{\text{term}}^\sigma = [[t_2]]_{\text{term}}^\sigma$。

##### **引理 4.2.1 (替换引理 / Substitution Lemma)**

若项 $t$ 的自由变量集为 $FV(t) \subseteq \{x_1, \dots, x_n\}$，且变量赋值 $\sigma: \mathcal{V} \to D_{\text{term}}$ 满足 $\sigma(x_i) = [s_i]$ 对于 $i=1,\dots,n$，则项 $t$ 在 $\sigma$ 下的解释等于将对应项 $s_i$ 替换 $t$ 中自由变量 $x_i$ 后得到的新项的等价类。形式化地：
$$ [[t]]_{\text{term}}^\sigma = [t\{s_1/x_1, \dots, s_n/x_n\}] $$
其中 $t\{\dots\}$ 表示对项 $t$ 并行地进行替换。

**证明**:
通过对项 $t$ 的结构进行归纳证明。为简洁起见，我们记替换 $S = \{s_1/x_1, \dots, s_n/x_n\}$。

*   **基本情况 1 (变量)**: 若 $t$ 是变量 $x_i$ ($1 \le i \le n$)，则：
    *   LHS = $[[x_i]]_{\text{term}}^\sigma = \sigma(x_i) = [s_i]$。
    *   RHS = $[x_i\{S\}] = [s_i]$。
    *   LHS = RHS。

*   **基本情况 2 (常量)**: 若 $t$ 是常量 $c \in \{T, \bot\}$，则：
    *   LHS = $[[c]]_{\text{term}}^\sigma = [c]$。
    *   RHS = $[c\{S\}] = [c]$ (替换对常量无影响)。
    *   LHS = RHS。

*   **归纳步骤**: 假设引理对项 $t_1$ 和 $t_2$ 成立。
    *   **情况 (·)**: 若 $t = (· \ t_1 \ t_2)$，则：
        $$\begin{align*}
        [[(· \ t_1 \ t_2)]]_{\text{term}}^\sigma &= \text{dot}_{\text{term}}([[t_1]]_{\text{term}}^\sigma, [[t_2]]_{\text{term}}^\sigma) && \text{(根据解释定义)}\\
        &= \text{dot}_{\text{term}}([t_1\{S\}], [t_2\{S\}]) && \text{(根据归纳假设)}\\
        &= [(· \ t_1\{S\} \ t_2\{S\})] && \text{(根据 dot}_{\text{term}} \text{ 定义)}\\
        &= [(· \ t_1 \ t_2)\{S\}] && \text{(根据替换定义)}\\
        \end{align*}$$
        引理对 $(· \ t_1 \ t_2)$ 成立。

    *   **情况 (equiv)**: 若 $t = (\text{equiv } t_1 \ t_2)$，证明过程与 `·` 的情况完全类似。

    *   **情况 (Quote)**: 若 $t = (\text{Quote } t_1)$，则：
        $$\begin{align*}
        [[(\text{Quote } t_1)]]_{\text{term}}^\sigma &= \text{quote}_{\text{term}}([[t_1]]_{\text{term}}^\sigma) && \text{(根据解释定义)}\\
        &= \text{quote}_{\text{term}}([t_1\{S\}]) && \text{(根据归纳假设)}\\
        &= [(\text{Quote } t_1\{S\})] && \text{(根据 quote}_{\text{term}} \text{ 定义)}\\
        \end{align*}$$
        根据语法的标准定义，替换操作会穿透 `Quote` 构造子作用于其内部的自由变量，即 $(\text{Quote } t_1)\{S\} = (\text{Quote } t_1\{S\})$。因此，LHS 等于 $[(\text{Quote } t_1)\{S\}]$。引理对 $(\text{Quote } t_1)$ 成立。

归纳得证。Q.E.D.

#### **定理 4.3 (可靠性 / Soundness)**

对于任意项 $t_1, t_2 \in \mathcal{T}$，若 $\vdash t_1 \equiv t_2$，则 $\mathcal{M}_{\text{term}} \models t_1 \equiv t_2$。

**证明**:
通过对证明 `⊢ t₁ ≡ t₂` 的长度进行归纳。我们需证明所有公理在 $\mathcal{M}_{\text{term}}$ 中均有效，且所有推理规则均保真。

**1. 基本情况：公理**
设 `A ≡ B` 是 MPL 的任意一个公理模式，其自由变量为 $\{x_1, \dots, x_n\}$。我们需要证明 $\mathcal{M}_{\text{term}} \models A \equiv B$，即对任意变量赋值 $\sigma: \mathcal{V} \to D_{\text{term}}$，都有 $[[A]]_{\text{term}}^\sigma = [[B]]_{\text{term}}^\sigma$。
设 $\sigma(x_i) = [s_i]$ 对于 $i=1,\dots,n$。
根据**替换引理 (引理 4.2.1)**，我们有：
*   $[[A]]_{\text{term}}^\sigma = [A\{s_1/x_1, \dots, s_n/x_n\}]$
*   $[[B]]_{\text{term}}^\sigma = [B\{s_1/x_1, \dots, s_n/x_n\}]$
令 $A'$ 和 $B'$ 分别是 $A$ 和 $B$ 在此替换下的实例项。要证明 $[[A]]_{\text{term}}^\sigma = [[B]]_{\text{term}}^\sigma$，我们只需证明 $[A'] = [B']$。根据等价类的定义，这等价于证明 $\vdash A' \equiv B'$。
由于 `A ≡ B` 是一个公理模式，其对任意项的任何实例（如此处的 `A' ≡ B'`）本身就是一条公理。因此，$\vdash A' \equiv B'$ 是可证的。故所有公理在 $\mathcal{M}_{\text{term}}$ 中均有效。

**2. 归纳步骤：推理规则**
我们以传递性规则和 B2 规则为例。

*   **(Transitivity)**: $\dfrac{\vdash t_1 \equiv t_2 \quad \vdash t_2 \equiv t_3}{\vdash t_1 \equiv t_3}$
    *   **归纳假设**: $\mathcal{M}_{\text{term}} \models t_1 \equiv t_2$ 且 $\mathcal{M}_{\text{term}} \models t_2 \equiv t_3$。
    *   根据有效性的定义，这意味着对所有 $\sigma$：
        $[[t_1]]_{\text{term}}^\sigma = [[t_2]]_{\text{term}}^\sigma$
        $[[t_2]]_{\text{term}}^\sigma = [[t_3]]_{\text{term}}^\sigma$
    *   由于模型中等价类的相等关系 ` = ` 是传递的，我们立即得到 $[[t_1]]_{\text{term}}^\sigma = [[t_3]]_{\text{term}}^\sigma$ 对所有 $\sigma$ 均成立。
    *   因此，$\mathcal{M}_{\text{term}} \models t_1 \equiv t_3$。该规则保真。

*   **(规则 B2)**: $\dfrac{\vdash t_1 \equiv (\text{Quote } t_2)}{\vdash (· \ T \ t_1) \equiv t_2}$
    *   **归纳假设**: $\mathcal{M}_{\text{term}} \models t_1 \equiv (\text{Quote } t_2)$。
    *   根据有效性的定义 (定义 4.2)，这意味着对于任意的变量赋值 $\sigma: \mathcal{V} \to D_{\text{term}}$，我们有：
        $$[[t_1]]_{\text{term}}^\sigma = [[(\text{Quote } t_2)]]_{\text{term}}^\sigma$$
    *   **待证结论**: 我们需要证明 $\mathcal{M}_{\text{term}} \models (· \ T \ t_1) \equiv t_2$。这意味着对于任意变量赋值 $\sigma$，我们必须证明：
        $$[[(· \ T \ t_1)]]_{\text{term}}^\sigma = [[t_2]]_{\text{term}}^\sigma$$
    *   **证明**:
        1.  令 $u_1 = [[t_1]]_{\text{term}}^\sigma$ 且 $u_2 = [[t_2]]_{\text{term}}^\sigma$。由于 $u_1, u_2$ 是域 $D_{\text{term}}$ 中的元素，它们是项的等价类。因此，存在代表元项 $s_1, s_2 \in \mathcal{T}$ 使得 $u_1 = [s_1]$ 且 $u_2 = [s_2]$。（注：$s_1, s_2$ 通常是 $t_1, t_2$ 经过 $\sigma$ 对应替换后的实例项）。
        2.  根据归纳假设和项解释的定义：
            $$u_1 = [[(\text{Quote } t_2)]]_{\text{term}}^\sigma = \text{quote}_{\text{term}}([[t_2]]_{\text{term}}^\sigma) = \text{quote}_{\text{term}}(u_2)$$
        3.  将 $u_1, u_2$ 替换为其代表元等价类：
            $$[s_1] = \text{quote}_{\text{term}}([s_2]) = [(\text{Quote } s_2)]$$
        4.  根据 $D_{\text{term}}$ 中等价类相等的定义，$[s_1] = [(\text{Quote } s_2)]$ 等价于以下可证判断：
            $$\vdash s_1 \equiv (\text{Quote } s_2)$$
        5.  现在，我们分析待证结论的左侧 (LHS) 和右侧 (RHS)。
            *   LHS = $[[(· \ T \ t_1)]]_{\text{term}}^\sigma = \text{dot}_{\text{term}}([[T]]_{\text{term}}^\sigma, [[t_1]]_{\text{term}}^\sigma) = \text{dot}_{\text{term}}([T], u_1) = \text{dot}_{\text{term}}([T], [s_1]) = [(· \ T \ s_1)]$
            *   RHS = $[[t_2]]_{\text{term}}^\sigma = u_2 = [s_2]$
        6.  因此，我们的目标是证明 LHS = RHS，即 $[(· \ T \ s_1)] = [s_2]$。
        7.  这再次等价于证明其对应的可证判断：
            $$\vdash (· \ T \ s_1) \equiv s_2$$
        8.  回顾第 4 步，我们已经从归纳假设中确立了 $\vdash s_1 \equiv (\text{Quote } s_2)$。将此可证判断作为证明论中**规则 B2** 的前提，我们恰好可以推导出 $\vdash (· \ T \ s_1) \equiv s_2$。
        9.  因此，我们证明了 $[(· \ T \ s_1)] = [s_2]$，即 LHS = RHS。由于此结论对任意变量赋值 $\sigma$ 均成立，我们断定 $\mathcal{M}_{\text{term}} \models (· \ T \ t_1) \equiv t_2$。

    故规则 B2 是保真的。

由于所有公理均有效，且所有推理规则均保真，可靠性定理得证。 Q.E.D.

#### **定理 4.4 (一致性 / Consistency)**

MPL 系统是一致的，即 $\nvdash T \equiv \bot$。

**证明**:
此证明通过建立典范模型 $\mathcal{M}_{\text{term}}$ 和第 3 节中具体的两元素模型 $\mathcal{M}_{\text{MPL}}$ 之间的联系来完成。

1.  **定义域和映射构造**:
    令 $D_{\text{term}}^0 \subseteq D_{\text{term}}$ 为**闭项 (closed terms)**（即不含自由变量的项）的等价类集合。我们定义一个从 $D_{\text{term}}^0$ 到两元素模型域 $D = \{v_T, v_\bot\}$ 的映射 $h: D_{\text{term}}^0 \to D$ 如下：
    对于任意 $[t] \in D_{\text{term}}^0$（其中 $t$ 是一个闭项），
    $$ h([t]) = [[t]]_{\mathcal{M}_{\text{MPL}}} $$
    其中 $[[t]]_{\mathcal{M}_{\text{MPL}}}$ 是闭项 $t$ 在模型 $\mathcal{M}_{\text{MPL}}$ 中的解释。由于 $t$ 是闭项，其解释不依赖于任何变量赋值，是一个在 $D$ 中确定的值。

2.  **验证映射的良定义性 (Well-Definedness)**:
    我们必须证明，若 $[t_1], [t_2] \in D_{\text{term}}^0$ 且 $[t_1] = [t_2]$，则 $h([t_1]) = h([t_2])$。
    *   前提 $[t_1] = [t_2]$ 意味着 $\vdash t_1 \equiv t_2$。
    *   根据 MPL 的**可靠性定理 (定理 3.3)**，若 $\vdash t_1 \equiv t_2$，则 $\mathcal{M}_{\text{MPL}} \models t_1 \equiv t_2$。
    *   根据**有效性的定义 (定义 3.2)**，这意味着对所有变量赋值 $\sigma$，都有 $[[t_1]]_{\mathcal{M}_{\text{MPL}}}^\sigma = [[t_2]]_{\mathcal{M}_{\text{MPL}}}^\sigma$。
    *   由于 $t_1$ 和 $t_2$ 都是闭项，它们的解释不依赖于 $\sigma$。因此，我们有 $[[t_1]]_{\mathcal{M}_{\text{MPL}}} = [[t_2]]_{\mathcal{M}_{\text{MPL}}}$。
    *   根据 $h$ 的定义，这正是 $h([t_1]) = h([t_2])$。
    *   因此，映射 $h$ 在闭项等价类上是良定义的。

3.  **反证法论证**:
    *   我们采用反证法，假设 MPL 系统是**不一致**的，即 $\vdash T \equiv \bot$。
    *   根据典范模型中等价类的定义，$\vdash T \equiv \bot$ 意味着在域 $D_{\text{term}}$ 中，$[T]$ 和 $[\bot]$ 是同一个元素：
        $$ [T] = [\bot] $$
    *   由于 $h$ 是一个良定义的函数，它必须将相同的输入映射到相同的输出。所以：
        $$ h([T]) = h([\bot]) $$
    *   现在，我们根据 $h$ 的定义来计算等式两边：
        *   左边: $h([T]) = [[T]] = I(T) = v_T$
        *   右边: $h([\bot]) = [[\bot]] = I(\bot) = v_\bot$
    *   因此，我们从不一致的假设推导出 $v_T = v_\bot$。
    *   这个结论与我们在**模型 $\mathcal{M}_{\text{MPL}}$ 的构造 (定义 3.1)** 中的基本设定 $v_T \neq v_\bot$ 相矛盾。

4.  **结论**:
    矛盾的根源在于我们最初的假设“MPL是不一致的”。因此，该假设必须为假。

我们得出结论：MPL 系统是一致的。 Q.E.D.

